Model aql_cities {
  type: 'query'
  label: 'aql_cities'
  description: ''
  data_source_name: 'demodb'
  dimension id {
    label: 'Id'
    type: 'number'
    hidden: false
    definition: @sql {{ #SOURCE.id }};;
  }
  dimension name {
    label: 'Name'
    type: 'text'
    hidden: false
    definition: @sql {{ #SOURCE.name }};;
  }
  dimension country_code {
    label: 'Country Code'
    type: 'text'
    hidden: false
    definition: @sql {{ #SOURCE.country_code }};;
  }

  owner: 'dat.cv+staging0@holistics.io'

  // query: @sql
  //   select {{ #ci.id }}, {{ #ci.name }}, {{ #ci.country_code }}
  //   from {{ #cities as ci }}
  //   left join {{ #countries as co }} on {{ #co.code }} = {{ #ci.country_code }};;

  query: @aql cities | select(id, name, country_code);;
  // query: @aql cities | select(id, name, cd) | aql_cities.country_code | count_distinct(aql_cities.country_code) ;;

  models: [
    cities,
    countries
  ]
}
