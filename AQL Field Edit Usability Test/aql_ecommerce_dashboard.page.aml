use H {
  themes
}

Dashboard aql_field_dashboard {
  title: 'AQL Ecommerce Dashboard'
  description: ''''''
  block title: TextBlock {
    content: @md # Canvas Dashboard;;
  }
  block v1: VizBlock {
    label: 'Percent of Total'
    viz: PivotTable {
      dataset: aql_field_edit_ut_dataset
      calculation total_orders_2 {
        label: 'Total Orders'
        formula: @aql count(orders.id);;
        calc_type: 'measure'
        data_type: 'number'
      }
      calculation percent_of_total {
        label: 'Percent Of Total'
        formula: @aql (total_orders_2 * 1.0) / (total_orders_2 | of_all(categories.name));;
        calc_type: 'measure'
        data_type: 'number'
      }
      rows: [
        VizFieldFull {
          ref: ref('categories', 'name')
          format {
            type: 'text'
          }
        }
      ]
      values: [
        VizFieldFull {
          ref: 'total_orders'
          format {
            type: 'number'
            pattern: 'inherited'
          }
        },
        VizFieldFull {
          ref: 'percent_of_total'
          format {
            type: 'number'
            pattern: '#,###0.00%'
            group_separator: ','
            decimal_separator: '.'
          }
        }
      ]
      settings {
        show_row_total: true
        show_column_total: true
        row_limit: 10000
        aggregate_awareness {
          enabled: true
          debug_comments: true
        }
      }
    }
  }

  view: CanvasLayout {
    label: 'View 1'
    height: 840
    grid_size: 20
    block title {
      position: pos(20, 20, 1160, 60)
    }
    block v1 {
      position: pos(640, 100, 540, 360)
    }
  }

  theme: themes.classic
}


Dashboard new_new_db = aql_field_dashboard.extend({
  block title: aql_field_dashboard.block.title.extend({
    content: @md # dfd ;;
  })
})